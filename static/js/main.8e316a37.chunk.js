(this.webpackJsonpolive=this.webpackJsonpolive||[]).push([[0],{79:function(e,t,n){},80:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=80},81:function(e,t,n){},86:function(e,t,n){"use strict";n.r(t);var c=n(2),o=n(0),a=n.n(o),i=n(10),r=n.n(i),s=(n(79),n(65)),l=n(123),u=n(49),d=n(38),j=n(16),b=n(57),f=n.n(b),v=n(66),h=Object(o.createContext)({});function p(e){var t=e.children,n=Object(o.useState)(null),a=Object(j.a)(n,2),i=a[0],r=a[1],s=Object(o.useState)(null),l=Object(j.a)(s,2),d=l[0],b=l[1],p=Object(o.useState)(!1),g=Object(j.a)(p,2),O=g[0],m=g[1],x=Object(o.useState)("main"),y=Object(j.a)(x,2),w=y[0],C=y[1],k=Object(o.useState)([]),S=Object(j.a)(k,2),P=S[0],N=S[1];return Object(o.useEffect)((function(){if(d&&O){var e=function(e){console.log(e),"message"===e.type?N&&N((function(t){return[].concat(Object(u.a)(t),[e[e.type]])})):"event"===e.type&&"messages"===e.event&&C("messages")};return d.on("data",e),function(){d.off("data",e)}}}),[O,d]),Object(o.useEffect)((function(){if(console.log("peer con set:",d,O),d&&!O){var e=function(){console.log("connected"),m(!0)};return d.on("open",e),function(){d.off("open",e)}}}),[d,O]),Object(o.useEffect)((function(){if(d){var e=function(){console.log("disconnected"),m(!1),b(null)},t=function(e){console.log("err",e),m(!1),b(null)};return d.on("close",e),d.on("error",t),function(){d.off("close",e),d.off("error",t)}}}),[d]),Object(o.useEffect)((function(){var e=new f.a(Object(v.a)(5),{host:"ciapeer.herokuapp.com",secure:!0}),t=function(t){r(e),console.log(t)},n=function(e){"unavailable-id"===e.type&&window.location.reload()},c=function(e){console.log("getting connection from",e.peer),b(e)};return e.on("open",t),e.on("error",n),e.on("connection",c),function(){e.off("open",t),e.off("error",n),e.off("connection",c)}}),[]),Object(c.jsx)(h.Provider,{value:{peer:i,peerConnection:d,messages:P,setPeerConnection:b,peerconState:O,setPeerconState:m,setMessage:N,pullPage:w,setPullPage:C},children:t})}var g=n(12),O=(n(81),n(62)),m=n.n(O),x=n(50),y=n.n(x),w=n(64),C=n.n(w),k=n(53),S=n.n(k),P=n(124),N=n(121),E=n(63),F=n.n(E),I=n(122);function T(e){return new Promise((function(t,n){navigator.clipboard?navigator.clipboard.writeText(e).then((function(){t(e)}),(function(e){n(e)})):t(function(e){var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{var n=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+n)}catch(c){console.error("Fallback: Oops, unable to copy",c)}document.body.removeChild(t)}(e))}))}var W=n(125);function D(){var e=Object(o.useContext)(h),t=e.peer,n=e.peerConnection,a=e.peerconState,i=e.pullPage,r=e.setPullPage,s=Object(o.useState)(0),l=Object(j.a)(s,2),u=l[0],b=l[1],f=Object(o.useState)(!1),v=Object(j.a)(f,2),p=v[0],O=v[1],m=Object(g.c)(0),x=Object(g.d)(m,[-100,0],["#0077ff","#161922"]),y=Object(o.useCallback)((function(e){switch(e){case 0:r("main");break;case 1:r("connect");break;case 2:t&&T(t.id),navigator.share&&t&&navigator.share({text:t.id});break;case 3:r("about");break;case 4:r("messages"),null===n||void 0===n||n.send({type:"event",event:"messages"})}}),[t,n,r]);return Object(o.useEffect)((function(){a&&r("connect")}),[a,r]),Object(o.useEffect)((function(){a||"messages"!==i||y(0)}),[i,a,y]),Object(c.jsxs)(g.b.div,{style:{background:a&&"messages"!==i?x:""},className:"home",children:[Object(c.jsx)(g.a,{children:p&&u>0?Object(c.jsx)(q,Object(d.a)({},{pullState:u})):""}),Object(c.jsx)(g.b.header,{drag:"messages"!==i&&"y",style:{y:m},onDragStart:function(){a||(O(!0),b(0))},onDragEnd:function(){a||O(!1),y(u)},onDrag:function(e,n){var c=-n.offset.y;t&&!a?c>250&&c<400?b(1):c>=400&&c<500?b(2):c>=500&&c<550?b(3):c<=250&&b(0):t&&a&&c>=400&&c<500&&b(4)},dragConstraints:{top:0,bottom:0},children:t?"main"===i?Object(c.jsx)(_,Object(d.a)({},{shade:p,pullState:u,peer:t})):"about"===i?Object(c.jsx)(J,{}):"connect"===i?Object(c.jsx)(B,{}):"messages"===i?Object(c.jsx)(L,{setPullPage:r}):Object(c.jsx)(c.Fragment,{}):Object(c.jsx)(g.b.div,{className:"connecting-loader",initial:{opacity:0,height:0,y:0,background:"#0077ff"},animate:{opacity:1,height:"auto",background:"coral",y:0},exit:{opacity:0,height:0},children:Object(c.jsx)(g.b.p,{initial:{opacity:0},animate:{opacity:1},transition:{repeat:1/0,repeatType:"reverse",stiffness:.2,damping:.5},children:"Assigning ID..."})})})]})}function L(e){var t=e.setPullPage;return Object(c.jsxs)(g.b.div,{animate:{opacity:1,height:window.innerHeight,background:"#161922"},className:"messages",children:[Object(c.jsx)(M,{}),Object(c.jsx)(A,{setPullPage:t}),Object(c.jsx)(U,{})]})}function M(){var e=Object(o.useContext)(h).peerConnection;return Object(c.jsxs)("header",{children:[Object(c.jsx)("h2",{children:"Olive"}),Object(c.jsxs)("p",{children:["Connected to ",null===e||void 0===e?void 0:e.peer]})]})}function U(){var e=Object(o.useContext)(h),t=e.peerConnection,n=e.setMessage,a=Object(o.useState)(!1),i=Object(j.a)(a,2),r=i[0],s=i[1],l=Object(o.useRef)(""),b=Object(o.useRef)();return Object(c.jsxs)("div",{className:"message-input",children:[Object(c.jsx)(W.a,{inputRef:b,fullWidth:!0,autoFocus:!0,multiline:!0,onChange:function(e){l.current=e.target.value,l.current.trim()?s(!0):s(!1)},inputProps:{style:{caretColor:"#0077ff",color:"white"}}}),Object(c.jsx)(m.a,{style:{color:"#0077ff",opacity:r?1:.5},onClick:function(){if(r){var e,c,o;console.log(l.current.trim());var a={text:l.current.trim()};null===t||void 0===t||t.send({message:a,type:"message"}),n&&n((function(e){return[].concat(Object(u.a)(e),[Object(d.a)(Object(d.a)({},a),{},{sent:!0})])})),(null===(e=b.current)||void 0===e?void 0:e.value)&&(b.current.value=""),(null===(c=b.current)||void 0===c?void 0:c.focus)&&(null===(o=b.current)||void 0===o||o.focus())}}})]})}function A(e){e.setPullPage;var t=Object(o.useContext)(h),n=t.messages;t.peerConnection,t.peerconState,t.setMessage;return Object(c.jsx)("div",{className:"messages-container",children:null===n||void 0===n?void 0:n.map((function(e,t){return Object(c.jsx)(R,{message:e},t)})).reverse()})}function R(e){var t=e.message;return Object(c.jsx)("div",{className:t.sent?"message sent-message":"message",children:Object(c.jsx)("p",{children:t.text})})}function B(){var e=Object(o.useState)(""),t=Object(j.a)(e,2),n=t[0],a=t[1],i=Object(o.useContext)(h),r=i.peer,s=i.peerConnection,l=i.peerconState,u=i.setPeerConnection,d=Object(o.useState)(""),b=Object(j.a)(d,2),f=b[0],v=b[1];function p(e){console.log("connecting to:",e);var t=null===r||void 0===r?void 0:r.connect(e);console.log(t),u&&u(t);var n=setInterval((function(){var c,o,a,i,r,s;console.log("checking connetionState",null===t||void 0===t||null===(c=t.peerConnection)||void 0===c?void 0:c.connectionState),(null===t||void 0===t||null===(o=t.peerConnection)||void 0===o?void 0:o.connectionState)&&"failed"===(null===t||void 0===t||null===(a=t.peerConnection)||void 0===a?void 0:a.connectionState)?(t.close(),u&&u(void 0),p(e),clearInterval(n)):((null===t||void 0===t||null===(i=t.peerConnection)||void 0===i?void 0:i.connectionState)&&"connected"===(null===t||void 0===t||null===(r=t.peerConnection)||void 0===r?void 0:r.connectionState)||!(null===t||void 0===t||null===(s=t.peerConnection)||void 0===s?void 0:s.connectionState))&&clearInterval(n)}),2e3)}return Object(o.useEffect)((function(){navigator.clipboard.readText().then((function(e){5===e.length&&a(e)})).catch((function(){}))}),[]),Object(o.useEffect)((function(){if(!s||!l){var e=setInterval((function(){n||navigator.clipboard.readText().then((function(e){return 5===e.length&&(a(e),!0)})).catch((function(){}))}),2e3);return function(){return clearInterval(e)}}}),[n,s,l]),Object(c.jsxs)(g.b.div,{initial:{opacity:0},animate:{opacity:1,height:l&&s?200:n?300:200,background:"#0077ff"},className:"connect-page",children:[Object(c.jsxs)("header",{children:[Object(c.jsx)("h2",{children:l&&s?"Connected to ".concat(s.peer):"Connect to ID"}),Object(c.jsx)(y.a,{})]}),l&&s?Object(c.jsx)(c.Fragment,{}):Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(P.a,{id:"partnerid",label:"partner id",defaultValue:"",InputProps:{style:{caretColor:"white",color:"white"}},autoFocus:!0,variant:"outlined",color:"secondary",onChange:function(e){v(e.target.value)}}),Object(c.jsx)(N.a,{disabled:!(5===f.length),variant:"text",color:"secondary",onClick:function(){return p(f)},children:"connect"})]}),n||l&&s?Object(c.jsx)("div",{className:"quick-connect",children:Object(c.jsxs)(I.a,{disabled:!(l||!s),onClick:function(){l&&s?s.close():p(n)},variant:"extended",style:l&&s?{background:"coral",color:"white"}:{},children:[l&&s?Object(c.jsx)(c.Fragment,{}):Object(c.jsx)(F.a,{}),Object(c.jsx)("p",{children:l||s?!l&&s?"connecting to ".concat(s.peer):"disconnect from ".concat(s&&s.peer):"connect to ".concat(n)})]})}):Object(c.jsx)(c.Fragment,{})]})}function J(){return Object(c.jsxs)(g.b.div,{initial:{opacity:0},animate:{opacity:1,height:120,background:"coral"},className:"about",children:[Object(c.jsxs)("header",{children:[Object(c.jsx)("h2",{children:"whats this?"}),Object(c.jsx)(S.a,{})]}),Object(c.jsx)("p",{children:"just a ux experiment and also u can use this to watch youtube with like one other person"})]})}function _(e){var t=e.shade,n=e.pullState,o=e.peer;return Object(c.jsxs)(g.b.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:200},className:"peer-id",children:[Object(c.jsx)("div",{className:"pull-up-indicator",children:Object(c.jsx)(g.b.span,{initial:{y:5},animate:{y:-5},transition:{repeat:1/0,repeatType:"reverse",stiffness:.2,damping:.5},children:t||0!==n?"drag to select":"pull up"})}),Object(c.jsx)("h6",{children:"you are"}),Object(c.jsx)("p",{children:null===o||void 0===o?void 0:o.id})]})}function q(e){var t=e.pullState,n=Object(o.useContext)(h),a=n.peerConnection,i=n.peerconState;return Object(c.jsxs)(g.b.div,{initial:{opacity:0,y:100},exit:{opacity:0,y:200},animate:{opacity:1,y:0},className:"shade-menu",children:[Object(c.jsxs)("div",{style:{background:3===t?"var(--accent)":""},className:"menu-item",children:[Object(c.jsx)("p",{children:"what is this?"}),Object(c.jsx)(S.a,{})]}),Object(c.jsxs)("div",{style:{background:2===t?"var(--accent)":""},className:"menu-item",children:[Object(c.jsx)("p",{children:"share id"}),Object(c.jsx)(C.a,{})]}),a?Object(c.jsxs)("div",{style:{background:i?"var(--accent)":"coral"},className:"menu-item",children:[Object(c.jsx)("p",{children:i?"connected to ".concat(a.peer):"connecting to ".concat(a.peer)}),Object(c.jsx)(y.a,{})]}):Object(c.jsxs)("div",{style:{background:1===t?"var(--accent)":""},className:"menu-item",children:[Object(c.jsx)("p",{children:"connect with"}),Object(c.jsx)(y.a,{})]})]})}var H=function(){var e=Object(s.a)({palette:{primary:{main:"#0077ff"},secondary:{main:"#ffff"}}});return Object(c.jsx)(l.a,{theme:e,children:Object(c.jsx)(p,{children:Object(c.jsx)(D,{})})})},V=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function $(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,126)).then((function(t){var n=t.getCLS,c=t.getFID,o=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),o(e),a(e),i(e)}))};r.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(H,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/olive",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/olive","/service-worker.js");V?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var c=n.headers.get("content-type");404===n.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):$(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):$(t,e)}))}}(),z()}},[[86,1,2]]]);
//# sourceMappingURL=main.8e316a37.chunk.js.map